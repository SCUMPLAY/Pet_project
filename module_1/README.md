# Итоговая работа Силантьев Сергей по Проекту 1. О о футбольных матчах.  
## Юнит 3. Введение в машинное обучение  
### skillfactory_rds  
![https://img.shields.io/badge/Python-3.7.4-blue](https://img.shields.io/badge/Python-3.7.4-blue)

## Оглавление  
[1. Описание модуля](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Описание-модуля)  
[2. Какой кейс решаем?](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Какой-кейс-решаем?)  
[3. Краткая информация о данных](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Краткая-информация-о-данных)  
[4. Полное описание задания с kaggle](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Полное-описание-задания-с-kaggle)  
[5. Шаблон ноутбука с параметрами модели](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Шаблон-ноутбука-с-параметрами-модели)  
[6. Краткое описание проделанной работы](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Краткое-описание-проделанной-работы)  
[7. Результат](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Результат)  


### Описание модуля  
Что вы получите в результате работы?  
- создадите свою первую модель, основанную на алгоритмах машинного обучения.
- примете участие в соревновании на Zindi.
- поймете как правильно "готовить" данные, чтобы ваша модель работала лучше.  

***Чем мы будем заниматься?***  
В этом модуле вы попробуете решить свой первый настоящий кейс и создадите первую модель, использующую алгоритмы машинного обучения.  
Не пугайтесь, вам не придётся совершать академический подвиг и изучать машинное обучение в экстремально короткие сроки! На самом деле код для создания и обучения модели мы вам предоставим в готовом виде, и этот код будет довольно простым: в нём не будет предусмотрен подбор параметров и тонкая настройка модели (всему этому вы научитесь позже, в курсе по ML). Пока ваша задача будет состоять в том, чтобы качественно подготовить данные для обучения модели. Скоро вы убедитесь, что тщательная очистка данных и генерация новых признаков (Feature Engineering ) способны повысить точность модели в 2 и более раз, и владение этими навыками играют в машинном обучении не меньшую роль, чем умение выбрать алгоритм и настроить модель.  
Итак, факт остается фактом: свою первую модель вы создадите уже через пару недель, а после этого, в следующие две недели, используете свои наработки для участия в первом в вашей жизни соревновании на платформе Zindi.ru  
:arrow_up:[к оглавлению](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Оглавление)

### Какой кейс решаем?
Футбол превратился в вид спорта на континенте, любим почти повсеместно и фанатично. Болельщики всегда пытались определить исход матча, а теперь с данными, полученными с разных датчиков и камер, вы можете делать эти прогнозы с большей уверенностью.
Это решение будет полезно Laduma Analytics для расширения типов предлагаемых услуг, а также будет полезно вам. Вы сможете произвести впечатление на своих друзей точностью своих прогнозов, применяя это к предстоящим играм в вашей стране.

### Краткая информация о данных
Данные для этой задачи собирались в течение 3 лет после 23 команд в африканской стране. Имена игрока и команды скрыты.
Датасет представлен в репозитории в папке [**Data** ](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/Data)  

:arrow_up:[к оглавлению](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Оглавление)

### Полное описание задания с zindi 
Данные включают в себя удары, передачи, захваты и ведение мяча — любое действие, которое происходит на игровом поле, записывается вместе с местом, где произошло событие (координаты X и Y). В случае пасов также есть точки конца X и конца Y — откуда и куда был сделан пас, а также кто отдал и кто получил мяч.
Комплект train рассчитан на два сезона, а test - на один сезон. 
Цель этой задачи — предсказать исход футбольного матча на основе исторических данных о матче и игроках.
Датасет представлен в репозитории в папке 
Условия соревнования:  
- Все участники должны использовать один и тот же алгоритм с параметрами, заданными по умолчанию.  
- Разрешено использовать внешние данные.  
- Решения буду проверяться преподавателями на их адекватность и воспроизводимость.  

Во вкладке Notebooks этого соревнования для Вас доступно Базовое решение (Baseline)
:arrow_up:[к оглавлению](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Оглавление)

### Шаблон ноутбука с параметрами модели  
Базовое решение (Baseline) содержит настройки для модели (LGBMClassfier) == ```model = LGBMClassfier(n_estimators=1000, random_state=RAND, objective = 'multiclass')```  
Полностью ноутбук с базовым решением (Baseline) можно посмотреть [по ссылке](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/Notebooks).  

:arrow_up:[к оглавлению](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Оглавление)

### Краткое описание проделанной работы

Этапы работ и главные моменты их реализации:
1. Импорт библиотек  
2. Импорт данных
3. EDA Анализ в себя включает.
  3.1. Просмотр общей информаии о данных.
  3.2. Визуализация данных для аналза данных.
  3.3. Анализ целевой переменной(3 класса{мультиклассификация})
  3.4. Разработка признаком и бинаризация целевой перменной {Score}
  3.5. Создания и проверка гипотез.  
4. Future Engineering
  4.1 Создания функция которая добавляет возможности в игровую статистику.
  4.2 Объединяем test и train набора данных, и бинаризуем категориальные и строковые данные.
  4.2 Заполняем пропуски
5. Modeling 
  5.1 Добавления функции в которой находится метрики классификации
  5.2 Добавления функции которая проверяет на переобучаемость модели
  5.3 Разбиения данных
6. Basline(5 модели)
  6.1 LogisticRegression()
  6.2 XGBClassifier
  6.3 RandomForestClassifier
  6.4 LGBMCLassifier
  6.5 CatBoostClassifier
7. Tuning(4 модели, добавляем гиерпарметры, и поиск по сетки)
  7.1 LogisticRegression()
  7.2 XGBClassifier
  7.3 RandomForestClassifier
  7.4 LGBMClassfier
8. Анализ важных признаков с помощью библиотки Shap
9. StackingClassfier(3 модели лучших по score)
   9.1 Модель - LogisticRegression
   9.2 Модель - RandomForestClassifier
   9.3 Модель - LGBMClassifier
    
:arrow_up:[к оглавлению](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Оглавление)


### Результат  
- score (по заданию метрика logloss) - 0.532  
- 10 место на zindi из 158 участников закрытого соревнования (Топ 10%).  
- Общая оценка за задание   - 94 из 100.  
- Оценка командой курса - 90 баллов из 100, в том числе:
  - Соблюдение стандартов оформления pep-8 = 75  
  - Наличие визуализации с выводами (корреляция и важность признаков) = 100  
  - Feature Engineering и обогащение датасета = 100, Работа с метрикой Logloss= 100      
:arrow_up:[к оглавлению](https://github.com/SCUMPLAY/Pet_project/edit/main/module_1/README.md#Оглавление)
